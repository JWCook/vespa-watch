if($(document).ready(function(){$("#lang").on("change",function(){document.forms["lang-form"].submit()})}),!VWConfig.debug){window.console||(window.console={});for(var methods=["log","debug","warn","info"],i=0;i<methods.length;i++)console[methods[i]]=function(){}}var VwObservationsMapPopup={props:["observation","editRedirect"],computed:{htmlId:function(){return"map-popup-"+this.observation.id},observationTime:function(){return moment(this.observation.observation_time).format("lll")},seeOnInatStr:function(){return gettext("See on iNaturalist")},viewDetailsStr:function(){return gettext("View details")},inaturalistUrl:function(){return"http://www.inaturalist.org/observations/"+this.observation.inaturalist_id},detailsUrl:function(){var t=new URL(this.observation.detailsUrl,VWConfig.baseUrl);return this.editRedirect&&t.searchParams.append("redirect_to",this.editRedirect),t}},template:'\n        <div :id="htmlId">\n            <h1>{{ observation.taxon }}</h1>\n           \n            <ul>\n                <li><b>Observation time: </b> {{ observationTime }}</li> \n                <li><b>Subject: </b> {{ observation.subject }}</li>\n                \n                <li v-if="observation.comments"><b>Comments: </b> {{ observation.comments }}</li>\n                <li v-if="observation.inaturalist_id"><a :href="inaturalistUrl" target="_blank">{{ seeOnInatStr }}</a></li>\n            </ul>\n            \n            <div v-if="observation.imageUrls.length > 0">\n                <img v-for="imageUrl in observation.imageUrls" class="theme-img-thumb" :src="imageUrl">\n            </div>\n            \n            <p>\n            <a :href="detailsUrl"> {{ viewDetailsStr }}</a>\n            </p>\n        </div>\n    '},VwObservationsVizMap={components:{"vw-observations-map-popup":VwObservationsMapPopup},data:function(){return{initialZoomed:!1,map:void 0,mapCircles:[],observationsLayer:void 0}},methods:{addObservationsToMap:function(){var t,e=VWConfig.map.circle;function n(t){return"individual"===t.subject?e.individualColor:"nest"===t.subject?"FD"===t.actionCode?e.nestColor.FD:"PD"===t.actionCode?e.nestColor.PD:"ND"===t.actionCode?e.nestColor.ND:e.nestColor.DEFAULT:e.unknownColor}this.observations.forEach(o=>{var i=L.circleMarker([o.latitude,o.longitude],{stroke:!0,weight:e.strokeWidth,color:n(o),opacity:e.strokeOpacity,fillColor:n(o),fillOpacity:e.fillOpacity,radius:(t=o,"individual"===t.subject?e.individualRadius:e.nestRadius),className:"circle"});console.log("Popup id: ",document.getElementById("map-popup-"+o.id)),i.bindPopup(document.getElementById("map-popup-"+o.id)),this.mapCircles.push(i)}),this.observationsLayer=L.featureGroup(this.mapCircles),this.observationsLayer.addTo(this.map),this.observationsLayer.bringToFront(),this.initialZoomed||this.map.fitBounds(this.observationsLayer.getBounds()),this.initialZoomed=!0},observationToHtml:function(t){var e="";return e+="<h1>"+t.taxon+"</h1>",null!=t.observation_time&&(e+=moment(t.observation_time).format("lll")+""),null!=t.subject&&(e+="<b>subject:</b> "+t.subject),null!=t.comments&&(e+="<p>"+t.comments+"</p>"),null!=t.inaturalist_id&&(e+='<a target="_blank" href="http://www.inaturalist.org/observations/'+t.inaturalist_id+'">iNaturalist observation</a>'),t.imageUrls.length>0&&t.imageUrls.forEach(function(t){e+='<img class="theme-img-thumb" src="'+t+'">'}),e+='<a href="/'+t.subject+"s/"+t.id+"/"+(this.editRedirect?"?redirect_to="+this.editRedirect:"")+'">View details</a>'},clearMap:function(){this.observationsLayer&&(this.observationsLayer.clearLayers(),this.mapCircles=[])},init:function(){var t=VWConfig.map,e=t.initialPosition,n=t.initialZoom;this.map=L.map("vw-map-map").setView(e,n),L.tileLayer(t.tileLayerBaseUrl,t.tileLayerOptions).addTo(this.map),this.zoneId&&axios.get(VWConfig.apis.zoneUrl,{params:{zone_id:this.zoneId}}).then(t=>{var e=L.geoJSON(t.data);e.addTo(this.map),e.bringToBack(),this.map.fitBounds(e.getBounds())}).catch(function(t){console.log(t)})}},mounted:function(){this.init()},props:["autozoom","editRedirect","observations","zoneId"],watch:{observations:function(t,e){console.log("vw-observations-viz-map: Observations got updated!"),this.clearMap(),Vue.nextTick(()=>{this.addObservationsToMap()})}},template:'<div>\n        <div class="mb-2" id="vw-map-map" style="height: 450px;"></div>\n        <div style="display: none;">\n            <vw-observations-map-popup v-for="observation in observations" :observation="observation" :edit-redirect="editRedirect" :key="observation.id"></vw-observations-map-popup>\n        </div>\n    </div>'},VwObservationsVizTimeSlider={data:function(){return{selectedTimeRange:{}}},props:["value"],computed:{startStr:function(){return moment(this.selectedTimeRange.start).format("D MMM YYYY")},stopStr:function(){return moment(this.selectedTimeRange.stop).format("D MMM YYYY")}},methods:{init:function(){var t=document.getElementById("vw-time-slider");null!=t.noUiSlider&&t.noUiSlider.destroy(),this.selectedTimeRange={start:this.value.start,stop:this.value.stop},noUiSlider.create(t,{range:{min:this.value.start,max:this.value.stop},step:6048e5,start:[this.value.start,this.value.stop],format:wNumb({decimals:0})}),t.noUiSlider.on("set",(t,e)=>{this.selectedTimeRange.start=parseInt(t[0]),this.selectedTimeRange.stop=parseInt(t[1]),this.$emit("time-updated",t.map(t=>parseInt(t)))}),t.noUiSlider.on("slide",(t,e)=>{this.selectedTimeRange.start=parseInt(t[0]),this.selectedTimeRange.stop=parseInt(t[1])})}},watch:{value:function(t,e){this.init()}},template:'\n        <div class="row align-items-center py-2 mb-2">\n            <div class="col-2">{{ startStr }}</div>\n            <div class="col"><div id="vw-time-slider"></div></div>\n            <div class="col-2 text-right">{{ stopStr }}</div>\n        </div>\n        '},VwObservationsViz={components:{"vw-observations-viz-time-slider":VwObservationsVizTimeSlider,"vw-observations-viz-map":VwObservationsVizMap},data:function(){return{observationsUrl:VWConfig.apis.observationsUrl,observations:[],observationsCF:void 0,cfDimensions:{},timeRange:{start:void 0,stop:void 0},totalObsCount:0}},methods:{getData:function(){var t=this.observationsUrl;null!=this.zone&&(t+="?zone="+this.zone),axios.get(t).then(t=>{console.log(t.data);var e=t.data.observations;this.setCrossFilter(e),this.totalObsCount=e.length,this.initTimerangeSlider(),this.setObservations()}).catch(function(t){console.log(t)})},initTimerangeSlider:function(){var t=this.cfDimensions.timeDim.top(1),e=this.cfDimensions.timeDim.bottom(1)[0].observation_time,n=t[0].observation_time;e===n&&n++,this.timeRange={start:e,stop:n}},setCrossFilter:function(t){this.observationsCF=crossfilter(t),this.cfDimensions.timeDim=this.observationsCF.dimension(function(t){return t.observation_time})},setObservations:function(){this.observations=this.cfDimensions.timeDim.top(this.totalObsCount)},filterOnTimeRange:function(t){this.cfDimensions.timeDim.filterRange(t),this.setObservations()}},mounted:function(){"1"===this.loadData&&this.getData()},props:["zone","loadData","editRedirect"],watch:{loadData:function(t,e){"1"===t&&this.getData()},zone:function(t,e){console.log("new zone passed in: "),console.log(t),this.getData()}},template:'\n        <section>\n            <vw-observations-viz-map :observations="observations" :edit-redirect="editRedirect" :zone-id="zone"></vw-observations-viz-map>\n            <vw-observations-viz-time-slider v-on:time-updated="filterOnTimeRange" v-model="timeRange"></vw-observations-viz-time-slider>\n        </section>\n        '},VwManagementActionModal={data:function(){return{actionOutcomesUrl:VWConfig.apis.actionOutcomesUrl,saveActionUrl:VWConfig.apis.actionSaveUrl,loadActionUrl:VWConfig.apis.actionLoadUrl,deleteActionUrl:VWConfig.apis.actionDeleteUrl,availabeOutcomes:[],errors:[],actionTime:"",outcome:"",personName:"",duration:"",deleteConfirmation:!1}},props:{mode:String,nestId:Number,actionId:Number},computed:{durationInMinutes:{get:function(){if(""!==this.duration)return this.duration/60},set:function(t){this.duration=""!==t?60*t:""}},modalTitle:function(){return"add"===this.mode?gettext("New management action"):gettext("Edit management action")},outcomeLabel:function(){return gettext("Outcome")},saveLabel:function(){return gettext("Save")},cancelLabel:function(){return gettext("Cancel")},deleteLabel:function(){return gettext("Delete")},yesDeleteLabel:function(){return gettext("Yes, delete")},nameLabel:function(){return gettext("Person name")},actionTimeLabel:function(){return gettext("Action time")},durationLabel:function(){return gettext("Duration")},inMinutesLabel:function(){return gettext("in minutes")},errorsLabel:function(){return gettext("Errors")},areYouSureStr:function(){return gettext("Are you sure you want to delete this action?")}},methods:{populateFromServer:function(){axios.get(this.loadActionUrl,{params:{action_id:this.actionId}}).then(t=>{console.log("received response",t),this.actionTime=t.data.action_time,this.outcome=t.data.outcome,this.duration=t.data.duration,this.personName=t.data.person_name})},deleteAction:function(){var t=this;axios.delete(this.deleteActionUrl,{params:{action_id:this.actionId}}).then(e=>{"OK"===e.data.result&&t.$emit("close",!0)},t=>{console.log("Error")})},save:function(){const t=new URLSearchParams;t.append("nest",this.nestId),t.append("action_time",this.actionTime),t.append("outcome",this.outcome),t.append("person_name",this.personName),t.append("duration",this.duration),"edit"===this.mode&&t.append("action_id",this.actionId);var e=this;axios.post(this.saveActionUrl,t).then(function(t){"OK"===t.data.result&&e.$emit("close",!0)}).catch(function(t){e.errors=t.response.data.errors})},loadOutcomes:function(){return axios.get(this.actionOutcomesUrl).then(t=>{this.availabeOutcomes=t.data}).catch(function(t){console.log(t)})}},mounted:function(){this.loadOutcomes().then(()=>{"edit"===this.mode&&this.populateFromServer()})},template:'\n<transition name="modal">\n      <div class="modal-mask">\n        <div class="modal-wrapper">\n\n        <div class="modal-dialog" role="document">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <h5 class="modal-title">{{ modalTitle }}</h5>\n                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n                    <span aria-hidden="true" @click="$emit(\'close\', false)">&times;</span>\n                    </button>\n                </div>\n                \n                <div v-if="deleteConfirmation">\n                    <div class="modal-body">{{ areYouSureStr }}</div>\n                    <div class="modal-footer">\n                        <button type="button" class="btn btn-dark" @click="deleteConfirmation=false">{{ cancelLabel }}</button>\n                        <button type="button" @click="deleteAction()" class="btn btn-danger">{{ yesDeleteLabel }}</button>\n                    </div>\n                </div>\n                <div v-else>\n                    <div class="modal-body">\n                        <div v-if="Object.keys(errors).length !== 0">\n                            <h6>{{ errorsLabel }}</h6>\n                            <ul > \n                                <li v-for="(errorList, fieldName) in errors">\n                                    {{ fieldName }}:\n                                    <span v-for="(err, index) in errorList">{{ err }} <span v-if="errorList.length-1<index">, </span> </span>\n                                </li>\n                            </ul>\n                        </div>\n                        <form>\n                            <div class="form-group">\n                                <label for="outcome">{{ outcomeLabel }} *</label>\n                                <select v-model="outcome" class="form-control" id="outcome">\n                                    <option :value="outcome.value" v-for="outcome in availabeOutcomes">{{ outcome.label }}</option>\n                                </select>\n                                <label for="personName">{{ nameLabel }}</label>\n                                <input v-model="personName" class="form-control" type="text" id="personName">\n                                \n                                <datetime v-model="actionTime" type="datetime" \n                                    input-class="datetimeinput form-control">\n                                    <label for="startDate" slot="before">{{ actionTimeLabel }} *</label>          \n                                </datetime>\n                \n                                <label for="duration">{{ durationLabel }}</label>\n                                <input v-model="durationInMinutes" class="form-control" type="number" id="duration">\n                                <small class="form-text text-muted">({{ inMinutesLabel }})</small>\n                            </div>\n                        </form>\n                    </div>\n                    <div class="modal-footer">\n                        <button type="button" class="btn btn-dark" @click="$emit(\'close\', false)">{{ cancelLabel }}</button>\n                        <button type="button" class="btn btn-primary" @click="save()">{{ saveLabel }}</button>\n                        <button v-if="mode === \'edit\'" type="button" @click="deleteConfirmation=true" class="btn btn-danger">{{ deleteLabel }}</button>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n        </div>\n      </div>\n    </transition>'},VwManagmentTableNestRow={components:{"vw-management-action-modal":VwManagementActionModal},computed:{hasManagementAction:function(){return""!==this.nest.action},managementActionID:function(){return this.nest.actionId},cannotEditLabel:function(){return gettext("You cannot edit this observation")},cannotEditTitle:function(){return gettext("This observation was created on iNaturalist. You cannot edit it here")},editStr:function(){return gettext("edit")},addStr:function(){return gettext("add")},editDeleteStr:function(){return gettext("edit / delete")},managementAction:function(){return gettext(this.nest.action)},nestClass:function(){return this.nest.action?"":"table-danger"},observationTimeStr:function(){return moment(this.nest.observation_time).format("lll")}},props:["nest"],data:function(){return{addActionModalOpened:!1,editActionModalOpened:!1}},methods:{showNewActionModal:function(){this.addActionModalOpened=!0},hideNewActionModal:function(t){this.addActionModalOpened=!1,t&&this.$emit("data-changed")},showEditActionModal:function(){this.editActionModalOpened=!0},hideEditActionModal:function(t){this.editActionModalOpened=!1,t&&this.$emit("data-changed")}},template:'\n        <tr :class="nestClass">\n            <td>{{ observationTimeStr }}</td>\n            \n            <td>{{ nest.address }}</td>\n            \n            <td>\n                <span v-if="hasManagementAction">\n                    {{ managementAction }}\n                    <button v-on:click="showEditActionModal()" class="btn btn-outline-info btn-sm">{{ editDeleteStr }}</button>\n                </span>\n                \n                <button v-else v-on:click="showNewActionModal()" class="btn btn-outline-info btn-sm">{{ addStr }}</button>\n                \n                <vw-management-action-modal v-if="editActionModalOpened" v-on:close="hideEditActionModal" mode="edit" :nest-id="nest.id" :action-id="nest.actionId"></vw-management-action-modal>\n                <vw-management-action-modal v-if="addActionModalOpened" v-on:close="hideNewActionModal" mode="add" :nest-id="nest.id"></vw-management-action-modal>\n            </td>\n            \n            <td>\n                    <a v-if="nest.originates_in_vespawatch" v-bind:href="nest.updateUrl">{{ editStr }}</a>\n                    <span v-if="!nest.originates_in_vespawatch" v-bind:title="cannotEditTitle">{{ cannotEditLabel }}</span>\n            </td>\n        </tr>\n        '},VwManagementTable={components:{"vw-management-table-nest-row":VwManagmentTableNestRow},computed:{dateStr:function(){return gettext("date")},addressStr:function(){return gettext("address")},managementStr:function(){return gettext("management")},loadingStr:function(){return gettext("Loading...")},noNestsStr:function(){return gettext("No nests yet!")},nestClass:function(){return"table-danger"}},data:function(){return{_nests:[]}},methods:{loadData:function(){null!=this.zone?this.$root.loadNests(this.zone):this.$root.loadNests()}},mounted:function(){this.loadData()},props:["nests","zone","currentlyLoading"],watch:{nests:function(t,e){this._nests=t}},template:'\n        <div class="row">\n            <span v-if="currentlyLoading">{{ loadingStr }}</span>\n            <template v-else>\n                <table v-if="nests.length > 0" class="table">\n                    <thead>\n                        <tr>\n                            <th>{{ dateStr }}</th><th>{{ addressStr }}</th><th>{{ managementStr }}</th><th></th>\n                        </tr>\n                    </thead>\n\n                    <vw-management-table-nest-row v-for="nest in nests" :nest="nest" :key="nest.id" v-on:data-changed="loadData"></vw-management-table-nest-row>\n                </table>\n                <div v-else>{{ noNestsStr }}</div>\n            </template>\n    </div>\n    '},VwRecentObsTableRow={props:["observation"],computed:{observationTimeStr:function(){return moment(this.observation.observation_time).format("lll")}},template:"<tr>\n                    <td>{{ observationTimeStr}}</td>\n                    <td>{{ observation.subject }}</td>\n                    <td>{{ observation.address }}</td>\n               </tr>"},VwRecentObsTable={components:{"vw-recent-obs-table-row":VwRecentObsTableRow},data:function(){return{currentlyLoading:!1,limit:10,observations:[]}},computed:{dateStr:function(){return gettext("date")},addressStr:function(){return gettext("address")},recentObsStr:function(){return gettext("Recent observations")},loadingStr:function(){return gettext("Loading...")},subjectStr:function(){return gettext("subject")}},methods:{loadObs:function(){this.currentlyLoading=!0;let t=VWConfig.apis.observationsUrl;axios.get(t+"?limit="+this.limit).then(t=>{t.data.observations&&(this.observations=t.data.observations),this.currentlyLoading=!1}).catch(function(t){console.log(t)})}},mounted:function(){this.loadObs()},template:'\n        <div class="row">\n            <div class="col">\n                <h2>{{ recentObsStr}}</h2>\n                <span v-if="currentlyLoading">{{ loadingStr }}</span>\n                <table v-else class="table">\n                    <thead>\n                        <tr>\n                            <th>{{ dateStr }}</th>\n                            <th>{{ subjectStr}}</th>\n                            <th>{{ addressStr }}</th>\n                        </tr>\n                    </thead>\n\n                    <vw-recent-obs-table-row v-for="observation in observations" :observation="observation" :key="observation.id"></vw-recent-obs-table-row>\n                </table>\n            </div>\n        </div>'},VwLocationSelectorLocationInput={data:function(){return{location:this.initAddress?""+this.initAddress:""}},computed:{positionLabel:function(){return gettext("Position")},searchLabel:function(){return gettext("Search")},detectPositionLabel:function(){return gettext("Detect current position")},orLabel:function(){return gettext("or")},typeALocationLabel:function(){return gettext('type a location here and click "Search"...')}},methods:{search:function(){this.$emit("search",this.location)}},props:["initAddress"],template:'\n        <div class="form-group">\n            <label for="id_position">{{positionLabel}}</label>\n            <div class="input-group">\n                <button class="btn btn-secondary" v-on:click.stop.prevent="$emit(\'autodetect-btn\')">{{ detectPositionLabel }}</button>\n                <label>{{ orLabel }}</label>\n                <input type="text" class="form-control" id="id_position" name="position" v-model="location" :placeholder="typeALocationLabel">\n                <div class="input-group-append">\n                    <button type="button" class="btn btn-secondary" v-on:click="search" >{{ searchLabel }}</button>\n                </div>\n            </div>\n        </div>\n        '},VwLocationSelectorMap={computed:{leafletPosition:function(){return[this.position[1],this.position[0]]}},data:function(){return{map:null,mapZoom:8,marker:null}},methods:{emitLongLat:function(){this.$emit("marker-move",[this.marker.getLatLng().lng,this.marker.getLatLng().lat])},setMarker:function(t,e){console.log("setting marker"),void 0!=this.marker&&this.map.removeLayer(this.marker),this.marker=L.marker([e,t],{draggable:!0}).addTo(this.map),this.marker.on("dragend",t=>{this.emitLongLat()})}},mounted:function(){this.map=L.map("vw-location-selector-map-map").setView(this.leafletPosition,this.mapZoom),L.tileLayer("https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}{r}.png").addTo(this.map),"true"===this.initMarker?(console.log("init with a marker"),this.setMarker(this.position[0],this.position[1]),this.map.setZoom(16),this.map.panTo(new L.LatLng(this.position[1],this.position[0]))):console.log("don't add a marker")},props:["position","initMarker"],template:'<div class="mb-2" id="vw-location-selector-map-map" style="height: 200px;"></div>',watch:{position:function(t,e){console.log("Map: position updated"),console.log(t),this.setMarker(t[0],t[1]),this.map.setZoom(16),this.map.panTo(new L.LatLng(t[1],t[0]))}}},VwLocationSelectorCoordinates={computed:{lat:{get:function(){return this.latitude},set:function(t){this.$emit("lat-updated",t)}},long:{get:function(){return this.longitude},set:function(t){this.$emit("lon-updated",t)}},latitudeLabel:function(){return gettext("Latitude")},longitudeLabel:function(){return gettext("Longitude")},addressLabel:function(){return gettext("Address")},_address:{get:function(){return this.address},set:function(){}}},props:["longitude","latitude","address"],template:'\n        <div class="form-row">\n            <div class="form-group col-md-3" id="div_id_latitude">\n                <label for="id_latitude">{{latitudeLabel}}</label>\n                <input type="text" class="form-control numberinput" id="id_latitude" name="latitude" v-model="lat">\n            </div>\n            <div class="form-group col-md-3" id="div_id_longitude">\n                <label for="id_longitude">{{longitudeLabel}}</label>\n                <input type="text" class="form-control numberinput" id="id_longitude" name="longitude" v-model="long">\n            </div>\n            <div class="form-group col-md-6" id="div_id_address">\n                <label for="id_address">{{addressLabel}}</label>\n                <input type="text" class="form-control numberinput" id="id_address" name="address" v-model="_address">\n            </div>\n        </div>\n        '},VwTaxonSelectorEntry={delimiters:["[[","]]"],props:{taxon:Object,radioName:String,pictureAttribute:String,selected:{type:Boolean,default:!1}},methods:{getRadioId:function(t){return"taxonRadios"+t.id}},template:'\n        <div class="card">\n            <div class="card-body">\n                <h5 class="card-title">[[ taxon.name ]]</h5>\n            \n                <img class="card-img-top" :src="taxon[pictureAttribute]" style="width: 100px;">\n            \n                <input class="form-check-input" type="radio" :name="radioName" :id="getRadioId(taxon)" :value="taxon.id" :checked="selected">\n                        \n                <label class="form-check-label" :for="getRadioId(taxon)">\n                    [[ taxon.name ]]\n                </label>\n            </div>\n        </div>'},VwTaxonSelector={components:{"vw-taxon-selector-entry":VwTaxonSelectorEntry},delimiters:["[[","]]"],props:{taxonApiUrl:String,radioName:String,taxonSelected:Number,mode:String,cannotChangeAnymore:{type:Boolean,default:!1}},computed:{buttonLabel:function(){return gettext("Show more species")},ifYouDontKnowMsg:function(){return gettext("If you don't know, select 'Insecta'.")},taxonCannotBeChangedMsg:function(){return gettext("Taxon can't be changed anymore.")},pictureAttrName:function(){switch(this.mode){case"nest":return"identification_picture_nest_url";case"individual":return"identification_picture_individual_url"}}},data:function(){return{taxaData:[],showAll:!1}},methods:{showAllIfNeeded:function(){if(this.taxonSelected){var t=this;this.taxaData.find(function(e){return e.id===t.taxonSelected}).identification_priority||(this.showAll=!0)}},getData:function(){axios.get(this.taxonApiUrl).then(t=>{this.taxaData=t.data,this.showAllIfNeeded()}).catch(function(t){console.log(t)})}},mounted:function(){this.getData()},template:'<div class="form-group">\n                    <template v-if="cannotChangeAnymore">\n                        <div v-for="taxon in taxaData" class="form-check-inline" v-if="taxon.id == taxonSelected">\n                            <vw-taxon-selector-entry :taxon="taxon" :picture-attribute="pictureAttrName" :radio-name="radioName" :selected="true"></vw-taxon-selector-entry>\n                        </div>\n                        <span class="small">[[ taxonCannotBeChangedMsg ]]</span>\n                    </template>\n                    \n                    <template v-else>\n                        <div v-for="taxon in taxaData" v-if="taxon.identification_priority" class="form-check-inline">\n                            <vw-taxon-selector-entry :taxon="taxon" :picture-attribute="pictureAttrName" :radio-name="radioName" :selected="taxon.id == taxonSelected"></vw-taxon-selector-entry>\n                        </div> \n                    \n                        <div>\n                            <button class="btn btn-outline-primary btn-sm" v-if="!showAll" v-on:click.stop.prevent="showAll = true">[[ buttonLabel ]]</button>\n                            <span class="small">[[ ifYouDontKnowMsg ]]</span>\n                        </div>\n                        \n                        \n                        <div v-if="showAll">\n                            <div v-for="taxon in taxaData" v-if="!taxon.identification_priority" class="form-check-inline">\n                                <vw-taxon-selector-entry :taxon="taxon" :picture-attribute="pictureAttrName" :radio-name="radioName" :selected="taxon.id == taxonSelected"></vw-taxon-selector-entry>\n                            </div>\n                        </div>         \n                    </template>\n                    \n               </div>'},VwDatetimeSelector={delimiters:["[[","]]"],props:{initDateTime:String,isRequired:Boolean,hiddenFieldName:String},data:function(){return{observationTime:void 0}},methods:{nowIsoFormat:function(){return(new Date).toISOString()}},computed:{observationTimeLabel:function(){return gettext("Observation date")}},mounted:function(){this.initDateTime&&(this.observationTime=this.initDateTime)},template:'<div class="form-group">\n                    <datetime v-model="observationTime" type="datetime" \n                              input-class="datetimeinput form-control" :max-datetime="nowIsoFormat()">\n                        <label for="startDate" slot="before">\n                            [[ observationTimeLabel ]]\n                            <span v-if="isRequired">*</span>\n                        </label>          \n                    </datetime>\n                    <input type="hidden" :name="hiddenFieldName" :value="observationTime"/>\n               </div>'},VwLocationSelector={data:function(){return{locationCoordinates:[this.initCoordinates[0],this.initCoordinates[1]],markerCoordinates:[this.initCoordinates[0],this.initCoordinates[1]],modelAddress:this.address?""+this.address:"",provider:new GeoSearch.OpenStreetMapProvider({params:{countrycodes:"BE"}})}},computed:{locationLng:function(){return this.locationCoordinates?this.locationCoordinates[0]:this.initCoordinates[0]},locationLat:function(){return this.locationCoordinates?this.locationCoordinates[1]:this.initCoordinates[1]}},components:{"vw-location-selector-location-input":VwLocationSelectorLocationInput,"vw-location-selector-map":VwLocationSelectorMap,"vw-location-selector-coordinates":VwLocationSelectorCoordinates},methods:{autodetectPosition:function(){var t=this;navigator.geolocation.getCurrentPosition(function(e){t.setCoordinates([e.coords.longitude,e.coords.latitude]),t.markerCoordinates=[e.coords.longitude,e.coords.latitude]})},getCoordinates:function(t){console.log("Address input changed to "+t+"+\n -> get coordinates and update locationCoordinates and markerCoordinates"),this.provider.search({query:t}).then(t=>{var e=t[0];console.log(t),this.locationCoordinates=[e.x,e.y],this.markerCoordinates=[e.x,e.y],this.modelAddress=e.label})},reverseGeocode:function(){var t=this;axios.get("https://nominatim.openstreetmap.org/reverse",{params:{format:"jsonv2",lat:t.locationCoordinates[1],lon:t.locationCoordinates[0]}}).then(e=>{t.modelAddress=e.data.display_name})},setCoordinates:function(t){console.log("Marker moved. Set locationCoordinates and update address."),this.locationCoordinates=t,this.reverseGeocode()},updateLatitude:function(t){console.log("latitude was updated"),this.markerCoordinates=[this.markerCoordinates[0],t]},updateLongitude:function(t){console.log("longitude was updated"),this.markerCoordinates=[t,this.markerCoordinates[1]]}},props:["initCoordinates","initMarker","address"],template:'\n        <section>\n            <vw-location-selector-location-input v-bind:init-address="address" v-on:autodetect-btn="autodetectPosition" v-on:search="getCoordinates"></vw-location-selector-location-input>\n            <vw-location-selector-map v-bind:init-marker="initMarker" v-bind:position="markerCoordinates" v-on:marker-move="setCoordinates"></vw-location-selector-map>\n            <vw-location-selector-coordinates v-bind:longitude="locationLng" v-bind:latitude="locationLat" v-bind:address="modelAddress" v-on:lon-updated="updateLongitude" v-on:lat-updated="updateLatitude"></vw-location-selector-coordinates>\n        </section>\n        '},app=new Vue({components:{"vw-observations-viz":VwObservationsViz,"vw-location-selector":VwLocationSelector,"vw-datetime-selector":VwDatetimeSelector,"vw-management-table":VwManagementTable,"vw-taxon-selector":VwTaxonSelector,"vw-recent-obs-table":VwRecentObsTable},data:{individuals:null,nests:null,currentlyLoading:!1},delimiters:["[[","]]"],el:"#vw-main-app",methods:{loadNests:function(t){this.currentlyLoading=!0;let e=VWConfig.apis.observationsUrl+"?type=nest";null!=t&&(e=e+"&zone="+t),axios.get(e).then(t=>{t.data.observations&&(this.nests=t.data.observations),this.currentlyLoading=!1}).catch(function(t){console.log(t)})}}});